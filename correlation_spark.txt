
scala> import org.apache.spark.mllib.stat.Statistics

scala> import org.apache.spark.mllib.linalg._

scala> val data = sc.textFile("finalprojectdata/finaldata.txt")

scala> val cor = data.map{ case(line:String) => val split = line.split(",");split.map(elem=> elem.toDouble)}.map(arr=>Vectors.dense(arr))

scala> val correlation = Statistics.corr(cor)
corrMatrix: org.apache.spark.mllib.linalg.Matrix =                              
1.0                   0.0628009421393315      ... (6 total)
0.0628009421393315    1.0                     ...
0.052410395429640794  -0.005971424672699589   ...
0.17434236972329115   0.07788853811571493     ...
-0.02217195597364457  -0.0027265029374011537  ...
0.11797303040303901   -0.01803410979497504    ...

scala> println(correlation.toString(6,Int.MaxValue))
1.0                   0.0628009421393315      0.052410395429640794   0.17434236972329115  -0.02217195597364457    0.11797303040303901    
0.0628009421393315    1.0                     -0.005971424672699589  0.07788853811571493  -0.0027265029374011537  -0.01803410979497504   
0.052410395429640794  -0.005971424672699589   1.0                    0.07464296615703828  -0.018176761558128387   0.042469689754246635   
0.17434236972329115   0.07788853811571493     0.07464296615703828    1.0                  -0.0667525611724819     0.09699239803609919    
-0.02217195597364457  -0.0027265029374011537  -0.018176761558128387  -0.0667525611724819  1.0                     -0.016951102326084554  
0.11797303040303901   -0.01803410979497504    0.042469689754246635   0.09699239803609919  -0.016951102326084554   1.0                    
